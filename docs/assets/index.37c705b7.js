var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(t,r,l)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[r]=l,o=(e,o)=>{for(var s in o||(o={}))r.call(o,s)&&n(e,s,o[s]);if(t)for(var s of t(o))l.call(o,s)&&n(e,s,o[s]);return e};"undefined"!=typeof require&&require;import{r as s,f as i,j as a,a as c,S as u,D as d,R as f}from"./vendor.0a7d5107.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const m={width:200,height:200},p=()=>{const e=s.exports.useRef(null),[t,r]=s.exports.useState(null),l=s.exports.useRef(null),n=s.exports.useRef(null),[f,p]=s.exports.useState(null),[h,v]=s.exports.useState(1),[b,g]=s.exports.useState(1);s.exports.useEffect((()=>{l.current&&(n.current=new i.fabric.Canvas(l.current,o({},m)))}),[l]),s.exports.useEffect((()=>{if(!t)return;const e=document.createElement("img");e.src=t,e.addEventListener("load",(()=>{var t;const r=new i.fabric.Image(e);null==(t=n.current)||t.add(r),p(r),r.on("selected",(({target:e})=>{p(e),v((null==e?void 0:e.scaleX)||1)}))}))}),[t]),s.exports.useEffect((()=>{v(1),g(1)}),[f]);const y=s.exports.useMemo((()=>{const{width:e=0,height:t=0}=o({},f);return{x:-(e*h-m.width)/2,y:-(t*h-m.height)/2,right:e*h-m.width,bottom:t*h-m.height}}),[f,h]),x=e=>{var t;console.log(f,e),null==f||f.set(e),null==(t=n.current)||t.requestRenderAll()};return a("div",{className:"w-screen h-screen py-30 flex flex-col justify-around",children:[c("input",{type:"file",ref:e,className:"hidden",accept:"image/png, image/jpeg",onChange:async()=>{var t;r(await(t=e.current,new Promise(((e,r)=>{if(null==t?void 0:t.files){const r=t.files[0],l=new FileReader;l.addEventListener("load",(function(){l.result&&e(l.result)})),l.readAsDataURL(r)}else r(Error())}))))}}),a("div",{className:"upload-preview",children:[c("canvas",{ref:l}),c("div",{className:"btn absolute -left-20 -top-20",onClick:()=>{x({left:0,top:0})},children:"L-T"}),c("div",{className:"btn absolute x-center -top-20",onClick:()=>{x({left:y.x,top:0})},children:"M-T"}),c("div",{className:"btn absolute -right-20 -top-20",onClick:()=>{x({left:-y.right,top:0})},children:"R-T"}),c("div",{className:"btn absolute -right-20 y-center",onClick:()=>{x({left:-y.right,top:y.y})},children:"R-M"}),c("div",{className:"btn absolute -right-20 -bottom-20",onClick:()=>{x({left:-y.right,top:-y.bottom})},children:"R-B"}),c("div",{className:"btn absolute x-center -bottom-20",onClick:()=>{x({left:y.x,top:-y.bottom})},children:"M-B"}),c("div",{className:"btn absolute -left-20 -bottom-20",onClick:()=>{x({left:0,top:-y.bottom})},children:"L-B"}),c("div",{className:"btn absolute -left-20 y-center",onClick:()=>{x({left:0,top:y.y})},children:"L-M"})]}),a("div",{className:"mt-20",children:[c("span",{className:"ml-12px",children:"尺寸："}),c(u,{min:.01,max:2,defaultValue:1,value:h,step:.01,onChange:e=>{var t,r;t=e,null==f||f.scale(t),v(t),null==(r=n.current)||r.requestRenderAll()}}),c("span",{className:"ml-12px",children:"透明度："}),c(u,{min:0,max:1,defaultValue:1,step:.1,value:b,onChange:e=>{var t,r;t=e,null==f||f.set({opacity:t}),g(t),null==(r=n.current)||r.requestRenderAll()}})]}),a("div",{className:"flex justify-around items-center",children:[c("div",{className:"btn",onClick:()=>{var t;null==(t=e.current)||t.click()},children:"上传图片"}),c("div",{className:"btn",onClick:()=>{var e;const t=window.devicePixelRatio||1,r=null==(e=n.current)?void 0:e.getElement(),l=null==r?void 0:r.getContext("2d");null==l||l.scale(t,t);const o=null==r?void 0:r.toDataURL("image/jpeg",1);d.alert({image:o,title:"长按下载图片"})},children:"生成"}),c("div",{className:"btn",children:"重置"})]})]})};f.render(c(p,{}),document.getElementById("root"));
